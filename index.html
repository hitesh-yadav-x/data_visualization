<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">

    <!-- Include d3.js version 5-->
    <script src="https://d3js.org/d3.v5.min.js" charset="utf-8"></script>

    <!-- Include the js files for chart code for data helper functions.-->
    <!-- The idea is to modularize the code so that not everything is in the same page.-->
    <script src="script/get_data.js" charset="utf-8"></script>
    <script src="script/helper_functions.js" charset="utf-8"></script>
    <script src="script/bar_daily.js" charset="utf-8"></script>
    <script src="script/bar_daily_by_hour.js" charset="utf-8"></script>
    <script src="script/heat_map.js" charset="utf-8"></script>

    <!-- Include CSS -->
    <link rel="stylesheet" href="css/page_layout.css">
    <style>
    </style>
</head>

<body>
    <div class="container">
        <div id="header_container_id" class="header_container">
            <h1>What hours do Illinos cars crash the most?</h1>
        </div>
        <div class="description">
            <p>The visualizations in this chart attempt to find the times when Illinois car crashes happen. Specifically
                what hours do the crashes happen.
                As a general understanding Illinois roads are busiest during the rush hours and coincidently we would
                assume most of the crashes happen during this time.
                Lets answer that using the crash data from <a href="https://data.cityofchicago.org/">Chicago Data
                    Portal</a>
                <br />
                We will use the Traffic Crashes - People transportation data. Which can be downloaded using <a
                    href="https://data.cityofchicago.org/Transportation/Traffic-Crashes-People/u6pd-qa9d">this link</a>.
            </p>
            <p>The crash data used for visualization starts from year 2018 and goes upto July 2022. I included 2022 yers
                data to validate if the traffic crash trend is similar to past 4 years. The inital visualizations will
                start with year 2021 with options to look at each of the years (2018 - partial 2022) to create a sens of
                data and check if any patterns can be made out of the visualization.</p>

        </div>
        <div class="main_chart">
            <div id="chart_container"></div>
            
        </div>
        <!--<div id="filter"></div>-->
        <div id="footer_container" class="footer">
            <div class="clicker">
            </div>
        </div>
    </div>
    <script>
        // SVG Container
        var width = 960,
            height = 400;

        var year_index = 1;
        var hour_index = 0;
        var all_total = [];
        var all_total_bar_hourly = [];
        var all_total_heat = [];
        var chartIndex = 1;
        const years = ['2022', '2021', '2020', '2019', '2018'];

        var margin = { top: 20, right: 20, bottom: 30, left: 180 },
            barGroupWidth = width - margin.left - margin.right,
            barGroupHeight = height - margin.top - margin.bottom;

        var gridSize = Math.floor((barGroupWidth - 75) / 24),

        chartTypeIndex = [0, 1, 2, 3];

        const navigatorSVG = d3.select('.clicker')
            .append('svg')
            .attr('width', 200)
            .attr('height', 100);

        const navButton = navigatorSVG.append('text')
            .attr('x', 0)
            .attr('y', 0)
            .attr('transform', 'translate(50, 50)')
            .text('Next>>')
            .attr('id', 0)
            .on('click', () => updateChart(chartIndex));

        // Draw initial chart
        dataBarDaily.then(d => drawBar(d, year_index));

        const updateChart = () => {
            if (chartIndex == 1) {
                chartIndex = chartIndex + 1;
                d3.select('#chart_container').select('svg').remove();
                d3.selectAll('#tooltip').remove();
                dataBarHourly.then(d => drawBarHourly(d[year_index], year_index, hour_index));
            }
            else if (chartIndex == 2){
                chartIndex = chartIndex + 1;
                d3.select('#chart_container').select('svg').remove();
                d3.selectAll('#tooltip').remove();
                dataHeatMap.then(d => drawHeatMap(d, year_index, false));
            }
        }

    </script>
</body>

</html>